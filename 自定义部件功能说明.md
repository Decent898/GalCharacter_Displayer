# 🎭 GINKA 自定义部件功能说明

## 功能概述

新增的自定义部件功能允许您为角色添加任意图片作为部件，并与角色的其他图层（眼部、嘴部等）一起进行层级管理。

## 使用流程

### 1. 选择角色实例
- 首先在"角色管理"标签页中添加一个角色
- 选择列表中的角色实例（点击角色列表中的项目）

### 2. 添加自定义部件
- 切换到"角色管理"标签页中的"自定义部件"子标签
- 当前选中的角色名称会显示在顶部
- 点击"选择图片文件"按钮
- 选择要添加的图片文件（支持png、jpg、jpeg、bmp、gif、tiff格式）

### 3. 调整部件属性
- **位置调整**: 使用X、Y滑块或输入框调整部件在角色上的位置
- **缩放调整**: 使用缩放滑块调整部件大小（0.1-3.0倍）
- **层级调整**: 使用层级按钮控制部件在前景/背景的显示顺序

### 4. 统一层级管理
- 在"图层"标签页中，可以看到角色的所有图层和自定义部件
- 自定义部件会以淡蓝色背景显示，标记为"[自定义]"
- 可以将自定义部件与角色原有图层一起进行层级调整

## 功能特点

### 🔗 角色绑定
- 每个自定义部件都与特定的角色实例绑定
- 不同角色可以有各自独立的自定义部件
- 切换角色时，自定义部件界面会自动更新

### 🎨 层级集成
- 自定义部件与角色图层使用统一的z-index系统
- 可以将自定义部件放在任意图层之间
- 支持精确的层级调整（上移、下移、置顶、置底）

### 💾 场景保存
- 自定义部件会随角色场景一起保存
- 加载场景时会自动恢复所有自定义部件的位置和属性
- 支持完整的场景导入导出

### 🖱️ 实时预览
- 所有调整都会在画布上实时显示
- 支持鼠标拖拽移动角色（包含自定义部件）
- 高质量图像渲染和缩放

## 使用技巧

### 层级管理策略
1. **背景装饰**: 将装饰性部件的z-index设置为较小值，显示在角色后面
2. **前景道具**: 将道具部件的z-index设置为较大值，显示在角色前面
3. **中间插入**: 可以将部件插入到角色的眼部和嘴部图层之间

### 部件命名
- 系统会自动为部件生成唯一名称
- 如果导入同名文件，会自动添加编号后缀
- 建议使用有意义的文件名，便于识别

### 性能优化
- 建议使用适当大小的图片文件
- 过大的图片会影响渲染性能
- 可以通过缩放功能调整显示大小而不需要修改原图

## 注意事项

- 自定义部件图片路径保存在场景文件中，移动图片文件可能导致加载失败
- 删除角色实例时，其关联的自定义部件也会被删除
- 自定义部件的变换是相对于角色实例的，角色移动时部件会跟随移动

---

**提示**: 这个功能特别适合为角色添加装饰品、道具、特效等元素，让角色立绘更加丰富多彩！
